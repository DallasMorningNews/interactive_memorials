$(document).ready(function(){function o(o){$.each(o,function(o,e){var a=s(e);$(".submissions").append(a)})}function e(o){var e=[];$.each(o,function(o,a){var n={location:a.location,lat:a.lat,"long":a["long"],races:[]};e.push(n)}),e=_.uniqBy(e,"location"),$.each(o,function(o,a){var n=a.location,r=a.race;$.each(e,function(o,e){n===e.location&&_.indexOf(e.races,r)===-1&&e.races.push(r)})}),a(e)}function a(o){o=GeoJSON.parse(o,{Point:["lat","long"],include:["race","location"]}),i.on("load",function(){i.addSource("memorials",{type:"geojson",data:o}),i.addLayer({id:"memorialSubmissions",source:"memorials",type:"circle",paint:{"circle-radius":{stops:[[1,10],[8,10],[16,9]]},"circle-color":"#FBD44B","circle-opacity":{property:"opacity",stops:[[0,0],[1,1]]}}})})}$("#see-form, .map-wrapper h1").click(function(){$("#form-wrapper").addClass("visible"),$("#see-form, .map-wrapper h1").hide()}),$(".close").click(function(){$("#form-wrapper").removeClass("visible"),$("#see-form, .map-wrapper h1").show()});var n,r,i=new mapboxgl.Map({container:"map",center:[-96.9785,32.8924],zoom:9,style:"http://maps.dallasnews.com/styles.json"});i.scrollZoom.disable(),i.addControl(new mapboxgl.Geocoder),mapboxgl.accessToken="pk.eyJ1IjoibWFjbWFuIiwiYSI6ImVEbmNmZjAifQ.zVzy9cyjNT1tMYOTex51HQ",i.addControl(new mapboxgl.Navigation),i.on("mousemove",function(o){var e=i.queryRenderedFeatures(o.point,{layers:["memorialSubmissions"]});i.getCanvas().style.cursor=e.length?"pointer":""});var s=Handlebars.compile($("#submission").html());$.getJSON("js/data.json",function(a){n=a,o(n),e(n)}),i.on("click",function(o){var e=i.queryRenderedFeatures(o.point,{layers:["memorialSubmissions"]});if(e.length){var a=e[0];r=o.lngLat===a.geometry.coordinates?a.geometry.coordinates:o.lngLat;(new mapboxgl.Popup).setLngLat(r).setHTML("<strong>"+a.properties.location+"</strong><br> Would you like to add a memorial submission here?").addTo(i)}}),i.on("click",function(o){var e;r=o.lngLat===e?e:o.lngLat;var a=(new mapboxgl.Popup).setLngLat(r).setHTML("This location has no submissions. Would you like to add one?").addTo(i),n=i.queryRenderedFeatures(o.point,{layers:["memorialSubmissions"]});if(n.length){var s=n[0];e=s.geometry.coordinates,a.remove();(new mapboxgl.Popup).setLngLat(r).setHTML("<strong>"+s.properties.location+"</strong><br> Would you like to add a memorial submission here?").addTo(i)}});var t=new Date,l=t.getFullYear();$(".copyright").text(l)});
//# sourceMappingURL=scripts-bundle.js.map
